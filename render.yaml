services:
  - type: web
    name: excellence-coaching-hub-frontend
    env: static
    buildCommand: cd frontend && npm install --legacy-peer-deps && PUBLIC_URL=/ npm run build
    staticPublishPath: ./frontend/build
    routes:
      - type: rewrite
        source: "/((?!static|manifest\\.json|favicon\\.ico|.*\\.(js|css|png|jpg|jpeg|gif|svg|woff|woff2|ttf|eot|ico)).*)$"
        destination: "/index.html"
    headers:
      - path: "/*"
        name: "Cache-Control"
        value: "no-cache, no-store, must-revalidate"
      - path: "/*"
        name: "X-Frame-Options"
        value: "DENY"
      - path: "/*"
        name: "X-Content-Type-Options"
        value: "nosniff"
      - path: "/static/*"
        name: "Cache-Control"
        value: "public, max-age=31536000, immutable"
      - path: "/*.js"
        name: "Cache-Control"
        value: "public, max-age=31536000, immutable"
      - path: "/*.js"
        name: "Content-Type"
        value: "application/javascript"
      - path: "/*.css"
        name: "Cache-Control"
        value: "public, max-age=31536000, immutable"
      - path: "/*.css"
        name: "Content-Type"
        value: "text/css"
      - path: "/*.json"
        name: "Content-Type"
        value: "application/json"
      - path: "/*.png"
        name: "Content-Type"
        value: "image/png"
      - path: "/*.jpg"
        name: "Content-Type"
        value: "image/jpeg"
      - path: "/*.svg"
        name: "Content-Type"
        value: "image/svg+xml"
      - path: "/*.woff"
        name: "Content-Type"
        value: "font/woff"
      - path: "/*.woff2"
        name: "Content-Type"
        value: "font/woff2"
    errorDocument: "/index.html"